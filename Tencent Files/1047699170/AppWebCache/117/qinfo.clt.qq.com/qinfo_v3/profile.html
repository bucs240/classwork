<!doctype html> <html> <head> <meta charset=utf-8> <meta http-equiv=Content-Security-Policy-Report-Only content="script-src 'self' *.qq.com *.url.cn *.idqqimg.com *.tenpay.com *.qlogo.cn 'unsafe-inline' 'unsafe-eval'; report-uri http://buluo.qq.com/cgi-bin/feedback/re/csp/15"> <title>群资料卡</title> <script>//关键点测速上报开始
window.timeScope = {};
window.timeScope['pagestart'] = {
    'start': new Date().getTime()
}</script> <link rel=stylesheet href=//s1.url.cn/qqun/qinfo_v3/css/profile-af45a5.css> <script>window.timeScope['cssload'] = {
    'start': new Date().getTime()
}</script> </head> <body class=profile data-speed=2 data-cssload=455040 data-jsload=455039 data-server=455020 data-local=455021 data-jsreload=455046 data-pv=455056 data-css=15 data-js=16> <div id=topWording class="yellow-wording hide"> <span class=text></span> <span class=icon-close></span> </div> <div id=wrap> <div id=main> <div class=item id=nameSection> <label for=name>群名称</label> <input type=text id=name class=border maxlength=96 placeholder=请输入群名称 tabindex=1> <label>群分类</label> <button id=type class=border aria-label=选择分类 role=button tabindex=1>&nbsp;</button> <div class="select-outer border border-top-none hide"> <div id=typeSelect1 class=select tabindex=1></div> <div id=typeSelect2 class=select tabindex=1></div> </div> </div> <div class=item id=jxSection style=display:none> <div class=item id=jxCity> <label>地区</label> <div class=jx-select-outer></div> </div> <div class=item id=jxSchool> <label>学校</label> <div class=jx-select-outer></div> </div> <div class=item id=jxClass> <label>班级</label> <div class=jx-select-outer></div> </div> </div> <div class=item id=detailSection style=display:none> <label>详情</label> <input type=text id=detailInput class="detail-value border hide" maxlength=40 /> <span id=detail class="detail-value border"></span> <div class="select-outer border border-top-none hide"></div> </div> <div class=item id=tagSection style=display:none> <div> <label for=keyword>群标签</label> <input type=text id=keyword class=border maxlength=24 placeholder=添加关键词，让群更容易被找到 tabindex=1> <button id=labelUp class=border aria-label=贴上标签 tabindex=1>贴上</button> </div> <div id=label></div> </div> <div class=item id=introSection> <label class=f-left>群介绍</label> <iframe id=iframe class="border f-left"></iframe> <div class="intro border"> <button class=icon-face title=表情 aria-lebel=选择表情 role=button tabindex=1></button> <span class=text>还能输入<span id=num>300</span>字</span> </div> <div class="face-selector hide"><div class=bg></div><div class=inner><a href=javascript:void(0) i=0 hidefocus=true role=button></a><a href=javascript:void(0) i=1 hidefocus=true role=button></a><a href=javascript:void(0) i=2 hidefocus=true role=button></a><a href=javascript:void(0) i=3 hidefocus=true role=button></a><a href=javascript:void(0) i=4 hidefocus=true role=button></a><a href=javascript:void(0) i=5 hidefocus=true role=button></a><a href=javascript:void(0) i=6 hidefocus=true role=button></a><a href=javascript:void(0) i=7 hidefocus=true role=button></a><a href=javascript:void(0) i=8 hidefocus=true role=button></a><a href=javascript:void(0) i=10 hidefocus=true role=button></a><a href=javascript:void(0) i=11 hidefocus=true role=button></a><a href=javascript:void(0) i=12 hidefocus=true role=button></a><a href=javascript:void(0) i=13 hidefocus=true role=button></a><a href=javascript:void(0) i=14 hidefocus=true role=button></a><a href=javascript:void(0) i=15 hidefocus=true role=button></a><a href=javascript:void(0) i=16 hidefocus=true role=button></a><a href=javascript:void(0) i=17 hidefocus=true role=button></a><a href=javascript:void(0) i=19 hidefocus=true role=button></a><a href=javascript:void(0) i=20 hidefocus=true role=button></a><a href=javascript:void(0) i=21 hidefocus=true role=button></a><a href=javascript:void(0) i=22 hidefocus=true role=button></a><a href=javascript:void(0) i=23 hidefocus=true role=button></a><a href=javascript:void(0) i=24 hidefocus=true role=button></a><a href=javascript:void(0) i=25 hidefocus=true role=button></a><a href=javascript:void(0) i=26 hidefocus=true role=button></a><a href=javascript:void(0) i=27 hidefocus=true role=button></a><a href=javascript:void(0) i=28 hidefocus=true role=button></a><a href=javascript:void(0) i=29 hidefocus=true role=button></a><a href=javascript:void(0) i=30 hidefocus=true role=button></a><a href=javascript:void(0) i=31 hidefocus=true role=button></a><a href=javascript:void(0) i=32 hidefocus=true role=button></a><a href=javascript:void(0) i=33 hidefocus=true role=button></a><a href=javascript:void(0) i=34 hidefocus=true role=button></a><a href=javascript:void(0) i=35 hidefocus=true role=button></a><a href=javascript:void(0) i=36 hidefocus=true role=button></a><a href=javascript:void(0) i=37 hidefocus=true role=button></a><a href=javascript:void(0) i=38 hidefocus=true role=button></a><a href=javascript:void(0) i=39 hidefocus=true role=button></a><a href=javascript:void(0) i=40 hidefocus=true role=button></a><a href=javascript:void(0) i=41 hidefocus=true role=button></a><a href=javascript:void(0) i=42 hidefocus=true role=button></a><a href=javascript:void(0) i=43 hidefocus=true role=button></a><a href=javascript:void(0) i=44 hidefocus=true role=button></a><a href=javascript:void(0) i=45 hidefocus=true role=button></a><a href=javascript:void(0) i=46 hidefocus=true role=button></a><a href=javascript:void(0) i=47 hidefocus=true role=button></a><a href=javascript:void(0) i=48 hidefocus=true role=button></a><a href=javascript:void(0) i=49 hidefocus=true role=button></a><a href=javascript:void(0) i=50 hidefocus=true role=button></a><a href=javascript:void(0) i=51 hidefocus=true role=button></a><a href=javascript:void(0) i=52 hidefocus=true role=button></a><a href=javascript:void(0) i=53 hidefocus=true role=button></a><a href=javascript:void(0) i=54 hidefocus=true role=button></a><a href=javascript:void(0) i=55 hidefocus=true role=button></a><a href=javascript:void(0) i=56 hidefocus=true role=button></a><a href=javascript:void(0) i=57 hidefocus=true role=button></a><a href=javascript:void(0) i=58 hidefocus=true role=button></a><a href=javascript:void(0) i=59 hidefocus=true role=button></a><a href=javascript:void(0) i=60 hidefocus=true role=button></a><a href=javascript:void(0) i=61 hidefocus=true role=button></a><a href=javascript:void(0) i=62 hidefocus=true role=button></a><a href=javascript:void(0) i=63 hidefocus=true role=button></a><a href=javascript:void(0) i=64 hidefocus=true role=button></a><a href=javascript:void(0) i=65 hidefocus=true role=button></a><a href=javascript:void(0) i=66 hidefocus=true role=button></a><a href=javascript:void(0) i=67 hidefocus=true role=button></a><a href=javascript:void(0) i=68 hidefocus=true role=button></a><a href=javascript:void(0) i=69 hidefocus=true role=button></a><a href=javascript:void(0) i=71 hidefocus=true role=button></a><a href=javascript:void(0) i=72 hidefocus=true role=button></a><a href=javascript:void(0) i=73 hidefocus=true role=button></a><a href=javascript:void(0) i=74 hidefocus=true role=button></a><a href=javascript:void(0) i=75 hidefocus=true role=button></a><a href=javascript:void(0) i=76 hidefocus=true role=button></a><a href=javascript:void(0) i=77 hidefocus=true role=button></a><a href=javascript:void(0) i=78 hidefocus=true role=button></a><a href=javascript:void(0) i=79 hidefocus=true role=button></a><a href=javascript:void(0) i=80 hidefocus=true role=button></a><a href=javascript:void(0) i=81 hidefocus=true role=button></a><a href=javascript:void(0) i=82 hidefocus=true role=button></a><a href=javascript:void(0) i=83 hidefocus=true role=button></a><a href=javascript:void(0) i=84 hidefocus=true role=button></a><a href=javascript:void(0) i=85 hidefocus=true role=button></a><a href=javascript:void(0) i=86 hidefocus=true role=button></a><a href=javascript:void(0) i=87 hidefocus=true role=button></a><a href=javascript:void(0) i=88 hidefocus=true role=button></a><a href=javascript:void(0) i=89 hidefocus=true role=button></a><a href=javascript:void(0) i=90 hidefocus=true role=button></a><a href=javascript:void(0) i=91 hidefocus=true role=button></a><a href=javascript:void(0) i=92 hidefocus=true role=button></a><a href=javascript:void(0) i=93 hidefocus=true role=button></a><a href=javascript:void(0) i=94 hidefocus=true role=button></a><a href=javascript:void(0) i=95 hidefocus=true role=button></a><a href=javascript:void(0) i=96 hidefocus=true role=button></a><a href=javascript:void(0) i=97 hidefocus=true role=button></a><a href=javascript:void(0) i=98 hidefocus=true role=button></a><a href=javascript:void(0) i=99 hidefocus=true role=button></a><a href=javascript:void(0) i=100 hidefocus=true role=button></a><a href=javascript:void(0) i=101 hidefocus=true role=button></a><a href=javascript:void(0) i=102 hidefocus=true role=button></a><a href=javascript:void(0) i=103 hidefocus=true role=button></a><a href=javascript:void(0) i=104 hidefocus=true role=button></a></div><div class=face-hover><div class=img><img class=face title=微笑 src=http://0.web.qstatic.com/webqqpic/style/face/0.gif alt=[/微笑] rel=face /></div><div class=name>微笑</div></div></div> </div> </div> </div> <script>//判断js加载是否成功,没有成功的话.从本地重载一次.
window.timeScope['jsloadstart'] = {
    'start': new Date().getTime()
};
var _isLoad = false,
    _monitorList = [];
var __monitor = function(id) {
    //__report('http://report.url.cn/report/report_vm?'+id);
    setTimeout(function() {
        var img = new Image();
        img.src = 'http://report.url.cn/report/report_vm?monitors=[' + id + ']&r=' + Math.random();
        img = null;
    }, 2000);
};

//上报属性收集
var _bodyDom = document.querySelector('body');
var _cssloadFail = _bodyDom.getAttribute('data-cssload'),
    _jsloadFail = _bodyDom.getAttribute('data-jsload'),
    _jsreload = _bodyDom.getAttribute('data-jsreload'),
    _serverLoad = _bodyDom.getAttribute('data-server'),
    _pv = _bodyDom.getAttribute('data-pv'),
    _localLoad = _bodyDom.getAttribute('data-local');
_bodyDom = null;

_monitorList.push(_pv);
//__monitor(_pv);

//js加载判断
function __jsLoad(e, flag) {
    if (flag) {
        //var newurl = 'http://'+location.host+'/qinfo_v3/js/lib/zepto.js';
        var old = e.src.split('/'),
            oldurl = old[old.length - 1],
            newurl = 'http://' + location.host + '/qinfo_v3/js/' + oldurl;
        if (oldurl.indexOf('zepto') >= 0) {
            newurl = 'http://' + location.host + '/qinfo_v3/lib/' + oldurl;
        }
        if (_isLoad) {
            __monitor(455034);
        } else {
            _monitorList.push(455034);
        }

    } else {
        var old = e.src.split('/'),
            oldurl = old[old.length - 1],
            newurl = 'http://' + location.host + '/qinfo_v3/js/' + oldurl;
        if (_isLoad) {
            __monitor(_jsloadFail);
        } else {
            _monitorList.push(_jsloadFail);
        }
    }

    var js = document.createElement('script');
    js.setAttribute('type', 'text/javascript');
    js.setAttribute('src', newurl);
    js.onload = function() {
        if (_isLoad) {
            flag ? __monitor(455099) : __monitor(_jsreload);
        } else {
            flag ? _monitorList.push(455099) : _monitorList.push(_jsreload);
        }
    }
    document.head.appendChild(js);
}

window.addEventListener('load', function() {
    //monitor pv上报
    setTimeout(function() {
        _isLoad = true;
        //__monitor(_pv);
        if (_monitorList.length) {
            __monitor(_monitorList.join(','));
        }
    }, 1000);
}, false);

var BJ_REPORT = (function(global) {
    if (global.BJ_REPORT) return global.BJ_REPORT;

    var _error = [];
    var orgError = global.onerror;
    global.onerror = function(msg, url, line, col, error) {
        var newMsg = msg;

        if (error && error.stack) {
            newMsg = _processStackMsg(error);
        }

        if (_isOBJByType(newMsg, "Event")) {
            newMsg += newMsg.type ? ('--' + newMsg.type + '--' + (newMsg.target ? (newMsg.target.tagName + "--" + newMsg.target.src) : "")) : "";
        }

        report.push({
            msg: newMsg,
            target: url,
            rowNum: line,
            colNum: col
                /*error : error*/
                /* stack : stack*/
        });

        _send();
        orgError && orgError.apply(global, arguments);

        __monitor(455028);
    };

    var _config = {
        id: 0,
        uin: 0,
        url: "",
        combo: 1,
        ext: {},
        level: 4, // 1-debug 2-info 4-error 8-fail
        ignore: [],
        random: 1,
        delay: 1000,
        submit: null
    };

    var _isOBJByType = function(o, type) {
        return Object.prototype.toString.call(o) === "[object " + (type || "Object") + "]";
    };

    var _isOBJ = function(obj) {
        var type = typeof obj;
        return type === 'object' && !!obj;
    };


    var _processError = function(errObj) {
        try {
            if (errObj.stack) {
                var url = errObj.stack.match('http://[^\n]+');
                url = url ? url[0] : "";
                var rowCols = url.match(':([0-9]+):([0-9]+)');
                if (!rowCols) {
                    rowCols = [0, 0, 0];
                }

                var stack = _processStackMsg(errObj);
                return {
                    msg: stack,
                    rowNum: rowCols[1],
                    colNum: rowCols[2],
                    target: url.replace(rowCols[0], '')
                        /* stack : stack*/
                };
            } else {
                return errObj;
            }
        } catch (err) {
            return errObj;
        }
    };

    var _processStackMsg = function(error) {
        var stack = error.stack.replace(/\n/gi, '').split(/\bat\b/).slice(0, 5).join("@").replace(/\?[^:]+/gi, "");
        var msg = error.toString();
        if (stack.indexOf(msg) < 0) {
            stack = msg + "@" + stack;
        }
        return stack;
    };

    var _error_tostring = function(error, index) {
        var param = [];
        var params = [];
        var stringify = [];
        if (_isOBJ(error)) {
            error.level = error.level || _config.level;
            for (var key in error) {
                var value = error[key] || "";
                if (value) {
                    if (_isOBJ(value)) {
                        try {
                            value = JSON.stringify(value);
                        } catch (err) {
                            value = "[BJ_REPORT detect value stringify error] " + err.toString();
                        }
                    }
                    stringify.push(key + ":" + value);
                    param.push(key + "=" + encodeURIComponent(value));
                    params.push(key + "[" + index + "]=" + encodeURIComponent(value));
                }
            }
        }

        // msg[0]=msg&target[0]=target -- combo report
        // msg:msg,target:target -- ignore
        // msg=msg&target=target -- report with out combo
        return [params.join("&"), stringify.join(","), param.join("&")];
    };

    var _imgs = [];
    var _submit = function(url) {
        if (_config.submit) {
            _config.submit(url);
        } else {
            var _img = new Image();
            _imgs.push(_img);
            _img.src = url;
        }
    };

    var error_list = [];
    var comboTimeout = 0;
    var _send = function(isReoprtNow) {
        if (!_config.report) return;

        while (_error.length) {
            var isIgnore = false;
            var error = _error.shift();
            var error_str = _error_tostring(error, error_list.length);
            for (var i = 0, l = _config.ignore.length; i < l; i++) {
                var rule = _config.ignore[i];
                if ((_isOBJByType(rule, "RegExp") && rule.test(error_str[1])) ||
                    (_isOBJByType(rule, "Function") && rule(error, error_str[1]))) {
                    isIgnore = true;
                    break;
                }
            }
            if (!isIgnore) {
                if (_config.combo) {
                    error_list.push(error_str[0]);
                } else {
                    _submit(_config.report + error_str[2] + "&_t=" + (+new Date));
                }
                _config.onReport && (_config.onReport(_config.id, error));
            }
        }

        // 合并上报
        var count = error_list.length;
        if (count) {
            var comboReport = function() {
                clearTimeout(comboTimeout);
                _submit(_config.report + error_list.join("&") + "&count=" + count + "&_t=" + (+new Date));
                comboTimeout = 0;
                error_list = [];
            };

            if (isReoprtNow) {
                comboReport(); // 立即上报
            } else if (!comboTimeout) {
                comboTimeout = setTimeout(comboReport, _config.delay); // 延迟上报
            }
        }
    };

    var report = {
        push: function(msg) { // 将错误推到缓存池
            if (Math.random() >= _config.random) {
                return report;
            }
            _error.push(_isOBJ(msg) ? _processError(msg) : {
                msg: msg
            });
            _send();
            return report;
        },
        info : function(msg){
            console.log(msg);
            if (!msg) {
                return report;
            }
            if (_isOBJ(msg)) {
                msg.level = 2;
            } else {
                msg = {
                    msg: msg,
                    level: 2
                };
            }
            report.push(msg);
            return report;
        },
        init: function(config) { // 初始化
            if (_isOBJ(config)) {
                for (var key in config) {
                    _config[key] = config[key];
                }
            }
            // 没有设置id将不上报
            var id = parseInt(_config.id, 10);
            if (id) {
                _config.report = (_config.url || "http://badjs2.qq.com/badjs") + "?id=" + id + "&uin=" + parseInt(_config.uin || (document.cookie.match(/\buin=\D+(\d+)/) || [])[1], 10) + "&from=" + encodeURIComponent(location.href) + "&ext=" + JSON.stringify(_config.ext) + "&";
            }
            return report;
        },

        __onerror__: global.onerror


    };

    return report;
}(window));

BJ_REPORT.init({
    id: 85
});</script> <script src=//s1.url.cn/qqun/qinfo_v3/libs/zepto-32008b.js></script> <script src=//s1.url.cn/qqun/qinfo_v3/js/profile-50d105.js></script> <div id=jsCssDetector class=js-css-detector style=height:0;font-size:0;height:0></div> <script>//测速上报..css.js检查等
window.timeScope['jsloadstart'] = {
    'end': new Date().getTime()
}

setTimeout(function() {
    //检查css加载情况
    function checkCssLoad() {
        var visibility = window.getComputedStyle(document.getElementById('jsCssDetector')).visibility;
        return visibility === 'hidden';
    }

    if (!checkCssLoad()) {
        window['__file_css_load_file'] = false;

        var oldCssUrl = document.querySelector('link').href,
            fls = oldCssUrl.split('/'),
            fileUrl = fls[fls.length - 1];
        var newCssUrl = 'http://' + location.host + '/qinfo_v3/css/' + fileUrl;

        //css切换到本地
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';

        link.href = newCssUrl;
        setTimeout(function() {
            if (checkCssLoad()) {
                //重新加载css成功
                if (_isLoad) {
                    __monitor(455043);
                } else {
                    _monitorList.push(455043);
                }
            }
        }, 5000);
        document.head[0].appendChild(link);
        if (_isLoad) {
            __monitor(_cssloadFail);
        } else {
            _monitorList.push(_cssloadFail);
        }
    }

}, 100);

var __global_env = '<!-- @echo CUR_ENV -->';
var _loadStatus;
if (__global_env == 'local') { // 本地化版本
    _loadStatus = _localLoad;
} else { // 服务端版本
    _loadStatus = _serverLoad;
}
if (_isLoad) {
    __monitor(_loadStatus);
} else {
    _monitorList.push(_loadStatus);
}</script> </body> </html> 